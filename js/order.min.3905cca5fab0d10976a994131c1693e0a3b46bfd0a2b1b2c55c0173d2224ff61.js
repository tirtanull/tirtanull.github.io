"use strict";const harga=[];fetch(window.location.origin+'/harga/harga.json').then(a=>a.json()).then(b=>{let c=b.harga.length,a=0;while([a]<c){let c=b.harga[a].id,d=b.harga[a].cost;harga[a]=[c,d],a++}}).then(()=>{Object.freeze(harga),init_menu()});let ambil_harga_dasar=b=>{let c=harga.length,a=0;while([a]<c){let c=harga[a][0];if(c===b)return harga[a][1];a++}},hitung_biaya_subtotal=a=>{let b=a.querySelector('.sub_total'),e=a.querySelectorAll('.item'),f=Array.prototype.slice.call(e),c=[];f.forEach(a=>{let b=Number(a.dataset.harga);c.push(b)});let d=c.reduce(function(a,b){return a+b},0);b.innerText=d.toLocaleString('id',{style:'currency',currency:'IDR'}),b.dataset.harga=d},hitung_biaya_grand_total=()=>{let a=[],d=document.querySelectorAll('.sub_total'),e=Array.prototype.slice.call(d),b=document.getElementById('grand-total');e.forEach(b=>{let c=Number(b.dataset.harga);a.push(c)});let c=a.reduce(function(a,b){return a+b},0);b.innerText=Number(c).toLocaleString('id',{style:'currency',currency:'IDR'}),b.dataset.harga=Number(c),whatsapp_info_gathering()},filter_menu=()=>{let a=document.getElementById("list-order").childElementCount,b=document.getElementById("menu-list-order").childElementCount;a===b?document.getElementById('add-service-button').classList.add('hide'):document.getElementById('add-service-button').classList.remove('hide')},hapus_order=()=>{let a=document.querySelectorAll('.hapus_order'),b=Array.prototype.slice.call(a);b.forEach(a=>{a.addEventListener('click',c=>{let b=a.parentNode.parentNode.parentNode.parentNode;b!==null&&(b.removeChild(a.parentNode.parentNode.parentNode),document.getElementById(a.dataset.target).classList.remove('hide'),filter_menu(),hitung_biaya_grand_total())})})},tambah_order=()=>{let a=document.querySelectorAll('.add-service'),b=Array.prototype.slice.call(a);b.forEach(a=>{a.addEventListener('click',d=>{a.parentNode.classList.add('hide');let b=document.getElementById(a.dataset.template),c=b.content.cloneNode(!0);document.getElementById('list-order').appendChild(c),document.getElementById('service-menu').classList.remove('up'),feather.replace(),a.dataset.template==='tpl-general-cleaning'?set_layanan_general_cleaning():a.dataset.template==='tpl-toilet'?set_layanan('pembersihan-toilet','toilet-item-template',1,'manual'):a.dataset.template==='tpl-cuci-karpet'?set_layanan('cuci-karpet','karpet-item-template',3,'dual'):a.dataset.template==='tpl-kritalisasi-marmer'?set_layanan('kritalisasi-marmer','kristalisasi-marmer-template',3,'auto'):a.dataset.template==='tpl-coating'?set_layanan('layanan-coating','coating-template',2,'manual'):a.dataset.template==='tpl-cuci-kasur'?set_layanan('layanan-cuci-kasur','kasur-template',1,'manual'):a.dataset.template==='tpl-soft-headboard'?set_layanan('layanan-soft-headboard','soft-headboard-template',1,'manual'):a.dataset.template==='tpl-cuci-sofa'?set_layanan('layanan-cuci-sofa','sofa-template',1,'manual'):a.dataset.template==='tpl-cuci-sofabed'&&set_layanan('layanan-cuci-sofabed','sofabed-template',1,'manual'),hapus_order(),filter_menu()})})},tutup_menu=()=>{let a=document.querySelector('.close-pop');a.addEventListener('click',b=>{a.parentNode.parentNode.parentNode.classList.remove('up')})},init_menu=()=>{let a=document.querySelector('.popme');a.addEventListener('click',c=>{let b=a.dataset.target;document.getElementById(b).classList.add('up'),filter_menu()}),tambah_order(),tutup_menu(),operasi_eksekusi_order()},init_pilihan_sub_item=c=>{let b=document.getElementById(c),a=b.querySelector('.pilih_produk');a.addEventListener('change',c=>{a.dataset.produk=a.value,a.dataset.title=c.target.options[c.target.selectedIndex].dataset.title,a.dataset.desc=c.target.options[c.target.selectedIndex].dataset.desc,hitung_biaya_subtotal(b)})},tambah_subitem_produk=(d,e)=>{let b=document.getElementById(d),c=b.querySelector('.pilih_produk'),f=b.querySelector('.list-order'),a=document.getElementById(e).content.cloneNode(!0);a.querySelector('.nama_produk').innerText=c.dataset.title,a.querySelector('.item').dataset.name=c.dataset.title,a.querySelector('.deskripsi_produk').innerText=c.dataset.desc,a.querySelector('.produk').dataset.produk=c.dataset.produk,f.appendChild(a),feather.replace();let g=b.querySelectorAll('.hapus-subitem'),h=Array.prototype.slice.call(g);h.forEach(a=>{a.addEventListener('click',c=>{a.parentNode.parentNode!==null&&(a.parentNode.parentNode.removeChild(a.parentNode),hitung_biaya_subtotal(b))})}),set_nama_item_perproduk()},set_nama_item_perproduk=()=>{let a=document.querySelectorAll('.nama-item'),b=Array.prototype.slice.call(a);b.forEach(a=>{a.addEventListener('change',c=>{let b=a.closest('li');b.dataset.name=a.value})})},operasi_eksekusi_order=()=>{let a=document.getElementById('form_eksekusi_order');document.getElementById('order-sekarang').addEventListener('click',b=>{b.preventDefault(),whatsapp_info_gathering(),a.querySelector('.whatsapp').click()})},whatsapp_info_gathering=()=>{let b=document.getElementById('form_eksekusi_order'),l=b.querySelector('.whatsapp'),c='+6288291973677',d='https://wa.me/'+c+'/?text=',e=document.getElementById('grand-total').dataset.harga,f=document.getElementById('io_name').value,g=document.getElementById('io_email').value,h=document.getElementById('io_tel').value,i=document.getElementById('io_plan').value,j=document.getElementById('io_addr').value,k='*Detail Pesanan (Test System)* %0a',a=' ----------------------------------------- %0a',m='Nama Pemesan : *'+f+'* %0a',n='Email :*'+g+'* %0a',o='Kontak :*'+h+'* %0a',p='Pengerjaan :*'+i+'* %0a',q='Biaya :*'+e+'* %0a',r='alamat : %0a'+j+' %0a';l.href=d+a+k+a+m+n+o+a+q+a+p+r},set_layanan_general_cleaning=()=>{let a=[],b=document.getElementById('general-cleaning'),c=b.querySelectorAll('.value'),d=Array.prototype.slice.call(c);set_harga_cleaning(a,'cleaning_perawatan'),tampilkan_biaya_cleaning(b,a[0]),b.querySelector('.layanan-gc').addEventListener('change',c=>{let d=c.target.value;set_harga_cleaning(a,d),tampilkan_biaya_cleaning(b,a),operasi_layanan_general_cleaning(b,a)}),d.forEach(c=>{c.addEventListener('change',c=>{operasi_layanan_general_cleaning(b,a)})})},set_harga_cleaning=(a,b)=>{let c=ambil_harga_dasar(b);a.length>0&&a.pop(),a.push(c)},tampilkan_biaya_cleaning=(a,b)=>{let c=a.querySelector('.biaya');c.innerText=b.toLocaleString('id',{style:'currency',currency:'IDR'})},operasi_layanan_general_cleaning=(a,d)=>{let e=a.querySelector('.panjang').value,f=a.querySelector('.lebar').value,g=a.querySelector('.tingkat').value,b=d*e*f*g,c=a.querySelector('.sub_total');c.innerText=b.toLocaleString('id',{style:'currency',currency:'IDR'}),c.dataset.harga=b,hitung_biaya_grand_total()},set_layanan=(a,b,c,d)=>{let f=document.getElementById(a),e=f.querySelector('.tambah-layanan');d==='manual'?e.addEventListener('click',d=>{operasi_layanan(a,b,c)}):d==='auto'?operasi_layanan(a,b,c):d==='dual'&&(operasi_layanan(a,b,c),e.addEventListener('click',d=>{operasi_layanan(a,b,c)}))},operasi_layanan=(a,d,b)=>{let c=document.getElementById(a);init_pilihan_sub_item(a),tambah_subitem_produk(a,d);let e=c.querySelectorAll('.value'),f=Array.prototype.slice.call(e);f.forEach(d=>{let a=d.parentNode.parentNode.parentNode,f=a.dataset.produk,e=ambil_harga_dasar(f);d.addEventListener('change',f=>{if(b===1){let a=c.querySelector('.jumlah').value;d.parentNode.parentNode.parentNode.parentNode.dataset.harga=e*a}else if(b===2){let b=a.querySelector('.panjang').value,c=a.querySelector('.lebar').value;d.parentNode.parentNode.parentNode.parentNode.dataset.harga=e*b*c}else if(b===3){let b=a.querySelector('.panjang').value,c=a.querySelector('.lebar').value,f=a.querySelector('.jumlah').value;d.parentNode.parentNode.parentNode.parentNode.dataset.harga=e*b*c*f}hitung_biaya_subtotal(c),hitung_biaya_grand_total()})})}