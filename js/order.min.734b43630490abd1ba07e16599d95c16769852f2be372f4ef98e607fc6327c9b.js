const harga=[];fetch(window.location.origin+'/harga/harga.json').then(a=>a.json()).then(b=>{let c=b.harga.length,a=0;while([a]<c){let c=b.harga[a].id,d=b.harga[a].cost;harga[a]=[c,d],a++}}).then(()=>{Object.freeze(harga),init_menu()});let ambil_harga_dasar=b=>{let c=harga.length,a=0;while([a]<c){let c=harga[a][0];if(c===b)return harga[a][1];a++}},hitung_biaya_subtotal=a=>{let b=a.querySelector('.sub_total'),e=a.querySelectorAll('.item'),f=Array.prototype.slice.call(e),c=[];f.forEach(a=>{let b=Number(a.dataset.harga);c.push(b)});let d=c.reduce(function(a,b){return a+b},0);b.innerText=d.toLocaleString('id',{style:'currency',currency:'IDR'}),b.dataset.harga=d},hitung_biaya_grand_total=()=>{let a=[],d=document.querySelectorAll('.sub_total'),e=Array.prototype.slice.call(d),b=document.getElementById('grand-total');e.forEach(b=>{let c=Number(b.dataset.harga);a.push(c)});let c=a.reduce(function(a,b){return a+b},0);b.innerText=Number(c).toLocaleString('id',{style:'currency',currency:'IDR'}),b.dataset.harga=Number(c),whatsapp_info_gathering()},filter_menu=()=>{let a=document.getElementById("list-order").childElementCount,b=document.getElementById("menu-layanan").childElementCount;a===b?document.getElementById('add-service-button').classList.add('hide'):document.getElementById('add-service-button').classList.remove('hide')},hapus_order=()=>{let a=document.querySelectorAll('.hapus_order'),b=Array.prototype.slice.call(a);b.forEach(a=>{a.addEventListener('click',()=>{let b=a.parentNode.parentNode.parentNode.parentNode;b!==null&&(b.removeChild(a.parentNode.parentNode.parentNode),document.getElementById(a.dataset.target).classList.remove('hide'),filter_menu(),hitung_biaya_grand_total())})})},tambah_order=()=>{let a=document.querySelectorAll('.add-service'),b=Array.prototype.slice.call(a);b.forEach(a=>{a.addEventListener('click',()=>{a.classList.add('hide');let b=document.getElementById(a.dataset.template),c=b.content.cloneNode(!0);document.getElementById('list-order').appendChild(c),document.getElementById('service-menu').classList.remove('up'),feather.replace(),a.dataset.template==='tpl-general-cleaning'?set_layanan_general_cleaning():a.dataset.template==='tpl-toilet'?set_layanan('pembersihan-toilet','toilet-item-template',1):a.dataset.template==='tpl-cuci-karpet'?set_layanan('cuci-karpet','karpet-item-template',3):a.dataset.template==='tpl-kritalisasi-marmer'?set_layanan('kritalisasi-marmer','kristalisasi-marmer-template',3):a.dataset.template==='tpl-coating'?set_layanan('layanan-coating','coating-template',2):a.dataset.template==='tpl-cuci-kasur'?set_layanan('cuci-kasur','kasur-template',1):a.dataset.template==='tpl-soft-headboard'?set_layanan('soft-headboard','soft-headboard-template',1):a.dataset.template==='tpl-cuci-sofa'?set_layanan('cuci-sofa','sofa-template',1):a.dataset.template==='tpl-cuci-sofabed'&&set_layanan('cuci-sofabed','sofabed-template',1),hapus_order(),filter_menu(),document.getElementsByTagName("BODY")[0].classList.remove('disable_scroll')})})},tutup_menu=()=>{let a=document.querySelector('.close-pop');a.addEventListener('click',()=>{document.getElementsByTagName("BODY")[0].classList.remove('disable_scroll'),a.parentNode.parentNode.parentNode.classList.remove('up')})},init_menu=()=>{let a=document.querySelector('.popme');a.addEventListener('click',()=>{let b=a.dataset.target,c=value_null_check();c==='granted'?(document.getElementById(b).classList.add('up'),document.getElementsByTagName("BODY")[0].classList.add('disable_scroll'),filter_menu()):console.log(' Field tidak terisi semuanya')}),tambah_order(),tutup_menu(),operasi_eksekusi_order()},init_pilihan_sub_item=c=>{let b=document.getElementById(c),a=b.querySelector('.pilih_produk');a!=null&&a.addEventListener('click',()=>{a.dataset.produk=a.value,a.dataset.title=event.target.options[event.target.selectedIndex].dataset.title,a.dataset.desc=event.target.options[event.target.selectedIndex].dataset.desc,a.dataset.target=event.target.options[event.target.selectedIndex].dataset.target,hitung_biaya_subtotal(b)})},tambah_subitem_produk=(c,d)=>{let b=document.getElementById(c),a=b.querySelector('.pilih_produk');if(a!=null){let g=b.querySelector('.list-order'),c=document.getElementById(d).content.cloneNode(!0),e=a.dataset.target;c.querySelector('.nama_produk').innerText=a.dataset.title,c.querySelector('.item').dataset.name=a.dataset.title,c.querySelector('.deskripsi_produk').innerText=a.dataset.desc,c.querySelector('.produk').dataset.produk=a.dataset.produk,e!=null&&(c.querySelector('.hapus-subitem').dataset.target=e),g.appendChild(c),feather.replace(),input_no_order(b,'tambah'),tampilkan_no_oder(b),e!=null&&(e==='coating_batu_alam'||e==='coating_vinyl'||(a.options[a.selectedIndex].classList.add('hide'),a.selectedIndex=0));let h=b.querySelectorAll('.hapus-subitem'),i=Array.prototype.slice.call(h);i.forEach(a=>{a.addEventListener('click',()=>{if(a.parentNode.parentNode!==null){a.parentNode.parentNode.removeChild(a.parentNode),hitung_biaya_subtotal(b),input_no_order(b),tampilkan_no_oder(b);let c=document.getElementById(a.dataset.target);c!=null&&c.classList.remove('hide')}})}),set_nama_item_perproduk();let f=a.dataset.title;(f!=='karpet'||f!=='Coating Vynil'||f!=='Coating Batu Alam')&&(f='')}},set_nama_item_perproduk=()=>{let a=document.querySelectorAll('.nama-item'),b=Array.prototype.slice.call(a);b.forEach(a=>{a.addEventListener('click',()=>{let b=a.closest('li');b.dataset.name=a.value})})},input_no_order=(c,d)=>{let a=c.querySelector('.list-order'),b=Number(a.dataset.order);d==='tambah'?a.dataset.order=b+1:a.dataset.order=b-1},tampilkan_no_oder=b=>{let a=b.querySelector('.list-order'),c=b.querySelector('.no-order');c!=null&&(Number(a.dataset.order)==0?a.previousElementSibling.classList.remove('hide'):a.previousElementSibling.classList.add('hide'))},set_layanan_general_cleaning=()=>{let a=[],b=document.getElementById('general-cleaning'),c=b.querySelectorAll('.value'),d=Array.prototype.slice.call(c);set_harga_cleaning(a,'cleaning_perawatan'),tampilkan_biaya_cleaning(b,a[0]),b.querySelector('.layanan-gc').addEventListener('click',()=>{let c=event.target.value;set_harga_cleaning(a,c),tampilkan_biaya_cleaning(b,a),operasi_layanan_general_cleaning(b,a)}),d.forEach(c=>{c.addEventListener('click',()=>{operasi_layanan_general_cleaning(b,a)})})},set_harga_cleaning=(a,b)=>{let c=ambil_harga_dasar(b);a.length>0&&a.pop(),a.push(c)},tampilkan_biaya_cleaning=(a,b)=>{let c=a.querySelector('.biaya');c.innerText=b.toLocaleString('id',{style:'currency',currency:'IDR'})},operasi_layanan_general_cleaning=(a,d)=>{let e=a.querySelector('.panjang').value,f=a.querySelector('.lebar').value,g=a.querySelector('.tingkat').value,b=d*e*f*g,c=a.querySelector('.sub_total');c.innerText=b.toLocaleString('id',{style:'currency',currency:'IDR'}),c.dataset.harga=b,hitung_biaya_grand_total()},set_layanan=(a,b,c)=>{let d=document.getElementById(a),e=d.querySelector('.tambah-layanan');init_pilihan_sub_item(a),e!=null?e.addEventListener('click',()=>{let e=value_null_check();if(e==='granted'){let e=options_null_check(d);e==='granted'&&operasi_layanan(a,b,c)}}):operasi_layanan(a,b,c)},operasi_layanan=(c,d,a)=>{let b=document.getElementById(c);tambah_subitem_produk(c,d);let e=b.querySelectorAll('.value'),f=Array.prototype.slice.call(e);f.forEach(d=>{let c=d.parentNode.parentNode.parentNode,f=c.dataset.produk,e=ambil_harga_dasar(f);d.addEventListener('click',()=>{if(a===1){let a=b.querySelector('.jumlah').value;d.parentNode.parentNode.parentNode.parentNode.dataset.harga=e*a}else if(a===2){let a=c.querySelector('.panjang').value,b=c.querySelector('.lebar').value;d.parentNode.parentNode.parentNode.parentNode.dataset.harga=e*a*b}else if(a===3){let a=c.querySelector('.panjang').value,b=c.querySelector('.lebar').value,f=c.querySelector('.jumlah').value;d.parentNode.parentNode.parentNode.parentNode.dataset.harga=e*a*b*f}hitung_biaya_subtotal(b),hitung_biaya_grand_total()})})},value_null_check=()=>{let b=document.querySelectorAll('.value'),c=Array.prototype.slice.call(b),a=[];return c.forEach(b=>{(b.value==null||b.value=="")&&(a.push('aborted'),b.nextElementSibling.innerText="Input data terlebih dahulu",setTimeout(function(){b.nextElementSibling.classList.remove('show')},800),b.nextElementSibling.classList.add('show'))}),a.length===0?'granted':'denied'},options_null_check=b=>{let a=b.querySelectorAll('.pilih_produk');if(a!=null){let c=Array.prototype.slice.call(a),b=[];return c.forEach(a=>{(a.dataset.title==null||a.dataset.title=="")&&(b.push('aborted'),setTimeout(function(){a.nextElementSibling.classList.remove('show')},800),a.nextElementSibling.classList.add('show'))}),b.length===0?'granted':'denied'}},operasi_eksekusi_order=()=>{let a=document.getElementById('form_eksekusi_order');document.getElementById('order-sekarang').addEventListener('click',()=>{event.preventDefault(),whatsapp_info_gathering(),a.querySelector('.whatsapp').click()})},whatsapp_info_gathering=()=>{let b=document.getElementById('form_eksekusi_order'),l=b.querySelector('.whatsapp'),c='+6288291973677',d='https://wa.me/'+c+'/?text=',e=document.getElementById('grand-total').dataset.harga,f=document.getElementById('io_name').value,g=document.getElementById('io_email').value,h=document.getElementById('io_tel').value,i=document.getElementById('io_plan').value,j=document.getElementById('io_addr').value,k='*Detail Pesanan (Test System)* %0a',a=' ----------------------------------------- %0a',m='Nama Pemesan : *'+f+'* %0a',n='Email :*'+g+'* %0a',o='Kontak :*'+h+'* %0a',p='Pengerjaan :*'+i+'* %0a',q='Biaya :*'+e+'* %0a',r='alamat : %0a'+j+' %0a';l.href=d+a+k+a+m+n+o+a+q+a+p+r}